rownames(mat.distances) <- df.geopoints$name
colnames(mat.distances) <- df.geopoints$name
return(mat.distances)
}
#CREATE MATRIX
geo_dist <- round(GeoDistanceInMetersMatrix(geo_suaeda) / 1000)
mantel(gendist_raw, geo_dist, method ="pearson", permutations = 9999)
coast <- read.csv(here("data", "geodist_coastline.csv"), row.names = 1, header = T,
stringsAsFactors = F)
coast[ , 1:30] <- apply(coast[ , 1:30], 2,
function(x) as.numeric(as.character(x)))
geodist_coastline <- coast %>% rename_all(~stringr::str_replace(.,"^X",""))
geodist_coast <- as.matrix(geodist_coastline)
mantel(gendist_raw, geodist_coast, method = "pearson", permutations = 9999)
same <- read.csv(here("data", "geodist_samecoast.csv"), row.names = 1, header = T,
stringsAsFactors = F)
same[ , 1:30] <- apply(same[ , 1:30], 2,
function(x) as.numeric(as.character(x)))
geodist_samecoast <- same %>% rename_all(~stringr::str_replace(.,"^X",""))
geodist_same <- as.matrix(geodist_samecoast)
mantel(gendist_raw, geodist_same, method = "pearson", permutations = 9999)
ocean <- read.csv(here("data","geodist_oceandist.csv"), row.names = 1, header = T,
stringsAsFactors = F)
ocean[ , 1:30] <- apply(ocean[ , 1:30], 2,
function(x) as.numeric(as.character(x)))
geodist_oceandist <- ocean %>% rename_all(~stringr::str_replace(.,"^X",""))
geodist_ocean <- as.matrix(geodist_oceandist)
mantel(gendist_raw, geodist_ocean, method = "pearson", permutations = 9999)
barrier <- read.csv(here("data","geodist_barrier.csv"), row.names = 1, header = T,
stringsAsFactors = F)
#made contents of data.frame characters for boxplot
barrier[ , 1:30] <- apply(barrier[ , 1:30], 2,
function(x) as.character(as.character(x)))
geodist_barrier <- barrier %>% rename_all(~stringr::str_replace(.,"^X",""))
geodist_barrier <- as.matrix(geodist_barrier)
str(geodist_barrier)
mantel(gendist_raw, geodist_barrier, method = "pearson", permutations = 9999)
?as.vector
#convert matrices to vectors
gend <- as.vector(gendist_raw)
geod <- as.vector(geo_dist)
geoc <- as.vector(geodist_coast)
geoo <- as.vector(geodist_ocean)
geob <- as.vector(geodist_barrier)
#make new data frame with vectorized distance matrices
mat <- data.frame(gend, geod)
mat2 <- data.frame(gend, geoc)
mat3 <- data.frame(gend, geoo)
mat4 <- data.frame(gend, geob)
#plot euclidean geographic distance
vis <- ggplot(mat, aes(y = gend, x = geod)) +
geom_smooth(method = "lm", alpha =0.51, colour = "blue") +
geom_point(size =2, alpha = 1) +
labs(y = "Genetic Distance (%)", x = "Geographic Distance (km)") +
theme( axis.text.x = element_text(face = "bold",colour = "black", size = 10),
axis.text.y = element_text(face = "bold", size = 10, colour = "black"),
axis.title= element_text(face = "bold", size = 12, colour = "black"),
panel.background = element_blank(),
panel.border = element_rect(fill = NA, colour = "black"),
strip.text = element_text(size = 9, face = "bold"))
vis
#plot coastal distance
vis2 <- ggplot(mat2, aes(y = gend, x = geoc)) +
geom_smooth(method = "lm", alpha =0.51, colour = "blue") +
geom_point(size =2, alpha = 1) +
labs(y = "Genetic Distance (%)", x = "Coastal Distance (km)") +
theme( axis.text.x = element_text(face = "bold",colour = "black", size = 10),
axis.text.y = element_text(face = "bold", size = 10, colour = "black"),
axis.title= element_text(face = "bold", size = 12, colour = "black"),
panel.background = element_blank(),
panel.border = element_rect(fill = NA, colour = "black"),
strip.text = element_text(size = 9, face = "bold"))
vis2
#plot oceanic distance
vis3 <- ggplot(mat3, aes(y = gend, x = geoo)) +
geom_smooth(method = "lm", alpha =0.51, colour = "blue") +
geom_point(size =2, alpha = 1) +
labs(y = "Genetic Distance (%)", x = "Oceanic Distance (km)") +
theme( axis.text.x = element_text(face = "bold",colour = "black", size = 10),
axis.text.y = element_text(face = "bold", size = 10, colour = "black"),
axis.title= element_text(face = "bold", size = 12, colour = "black"),
panel.background = element_blank(),
panel.border = element_rect(fill = NA, colour = "black"),
strip.text = element_text(size = 9, face = "bold"))
vis3
#plot ancient sea barrier absent/present
vis4 <- ggplot(mat4, aes(y = gend, x = geob)) +
geom_boxplot() +
#geom_jitter(alpha = 0.5, width = 0.2) +
labs(y = "Genetic Distance (%)", x = "Biogeographic Barrier Absent/Present (0/1)") +
theme( axis.text.x = element_text(face = "bold",colour = "black", size = 10),
axis.text.y = element_text(face = "bold", size = 10, colour = "black"),
axis.title= element_text(face = "bold", size = 12, colour = "black"),
panel.background = element_blank(),
panel.border = element_rect(fill = NA, colour = "black"),
strip.text = element_text(size = 9, face = "bold"))
vis4
#export plots as pdf
ggsave(
filename = here::here("final-figures", "euclidean.pdf"),
plot = "vis",
device = "pdf",
scale = 1,
dpi = 720,
limitsize = TRUE,
)
#export plots as pdf
ggsave(
filename = here::here("final-figures", "euclidean"),
plot = "vis",
device = "pdf",
scale = 1,
dpi = 720,
limitsize = TRUE,
)
#export plots as pdf
ggsave(
filename = here::here("final-figures", "euclidean.pdf"),
plot = vis,
device = "pdf",
scale = 1,
dpi = 720,
limitsize = TRUE,
)
#plot with barrier of peninsula absent/present with points
vis5 <- ggplot(mat4, aes(y = gend, x = geob)) +
geom_boxplot() +
geom_jitter(alpha = 0.5, width = 0.2) +
labs(y = "Genetic Distance (%)", x = "Biogeographic Barrier Absent/Present (0/1)") +
theme( axis.text.x = element_text(face = "bold",colour = "black", size = 10),
axis.text.y = element_text(face = "bold", size = 10, colour = "black"),
axis.title= element_text(face = "bold", size = 12, colour = "black"),
panel.background = element_blank(),
panel.border = element_rect(fill = NA, colour = "black"),
strip.text = element_text(size = 9, face = "bold"))
ggsave(
filename = here::here("final-figures", "barrier_points.pdf"),
plot = vis5,
device = "pdf",
scale = 1,
dpi = 720,
limitsize = TRUE,
)
ggsave(
filename = here::here("final-figures", "barrier.pdf"),
plot = vis4,
device = "pdf",
scale = 1,
dpi = 720,
limitsize = TRUE,
)
ggsave(
filename = here::here("final-figures", "oceanic.pdf"),
plot = vis3,
device = "pdf",
scale = 1,
dpi = 720,
limitsize = TRUE,
)
ggsave(
filename = here::here("final-figures", "coastal.pdf"),
plot = vis2,
device = "pdf",
scale = 1,
dpi = 720,
limitsize = TRUE,
)
write.csv(gendist_raw, here("data", "gendist_raw.csv"))
#CREATE MATRIX
#divide by 1000 to make units km
geodist_euclidean <- round(GeoDistanceInMetersMatrix(geo_suaeda) / 1000)
geod <- as.vector(geodist_euclidean)
#make new data frame with vectorized distance matrices
mat <- data.frame(gend, geod)
mat2 <- data.frame(gend, geoc)
mat3 <- data.frame(gend, geoo)
mat4 <- data.frame(gend, geob)
#plot euclidean geographic distance
vis <- ggplot(mat, aes(y = gend, x = geod)) +
geom_smooth(method = "lm", alpha =0.51, colour = "blue") +
geom_point(size =2, alpha = 1) +
labs(y = "Genetic Distance (%)", x = "Geographic Distance (km)") +
theme( axis.text.x = element_text(face = "bold",colour = "black", size = 10),
axis.text.y = element_text(face = "bold", size = 10, colour = "black"),
axis.title= element_text(face = "bold", size = 12, colour = "black"),
panel.background = element_blank(),
panel.border = element_rect(fill = NA, colour = "black"),
strip.text = element_text(size = 9, face = "bold"))
vis
#export plots as pdf
ggsave(
filename = here::here("final-figures", "euclidean.png"),
plot = vis,
width = 20,
height = 20,
units = "cm",
dpi = 720
)
ggsave(
filename = here::here("final-figures", "coastal.png"),
plot = vis2,
width = 20,
height = 20,
units = "cm",
dpi = 720
)
ggsave(
filename = here::here("final-figures", "oceanic.png"),
plot = vis3,
width = 20,
height = 20,
units = "cm",
dpi = 720
)
ggsave(
filename = here::here("final-figures", "barrier.png"),
plot = vis4,
width = 20,
height = 20,
units = "cm",
dpi = 720
)
ggsave(
filename = here::here("final-figures", "barrier_points.png"),
plot = vis5,
width = 20,
height = 20,
units = "cm",
dpi = 720
)
ggsave(
filename = here::here("final-figures", "barrier_points.png"),
plot = vis5,
width = 20,
height = 10,
units = "cm",
dpi = 720
)
ggsave(
filename = here::here("final-figures", "barrier_points.png"),
plot = vis5,
width = 20,
height = 15,
units = "cm",
dpi = 720
)
#export plots as pdf
ggsave(
filename = here::here("final-figures", "euclidean.png"),
plot = vis,
width = 20,
height = 15,
units = "cm",
dpi = 720
)
ggsave(
filename = here::here("final-figures", "coastal.png"),
plot = vis2,
width = 20,
height = 15,
units = "cm",
dpi = 720
)
ggsave(
filename = here::here("final-figures", "oceanic.png"),
plot = vis3,
width = 20,
height = 15,
units = "cm",
dpi = 720
)
ggsave(
filename = here::here("final-figures", "barrier.png"),
plot = vis4,
width = 20,
height = 15,
units = "cm",
dpi = 720
)
ggsave(
filename = here::here("final-figures", "barrier_points.png"),
plot = vis5,
width = 20,
height = 15,
units = "cm",
dpi = 720
)
#plot with barrier of peninsula absent/present with points
vis5 <- ggplot(mat4, aes(y = gend, x = geob)) +
geom_boxplot() +
geom_jitter(alpha = 0.5, width = 0.2) +
labs(y = "Genetic Distance (%)", x = "Biogeographic Barrier Absent/Present (0/1)") +
theme( axis.text.x = element_text(face = "bold",colour = "black", size = 12),
axis.text.y = element_text(face = "bold", size = 12, colour = "black"),
axis.title= element_text(face = "bold", size = 12, colour = "black"),
panel.background = element_blank(),
panel.border = element_rect(fill = NA, colour = "black"),
strip.text = element_text(size = 9, face = "bold"))
ggsave(
filename = here::here("final-figures", "barrier_points.png"),
plot = vis5,
width = 20,
height = 15,
units = "cm",
dpi = 720
)
#plot with barrier of peninsula absent/present with points
vis5 <- ggplot(mat4, aes(y = gend, x = geob)) +
geom_boxplot() +
geom_jitter(alpha = 0.5, width = 0.2) +
labs(y = "Genetic Distance (%)", x = "Biogeographic Barrier Absent/Present (0/1)") +
theme( axis.text.x = element_text(face = "bold",colour = "black", size = 15),
axis.text.y = element_text(face = "bold", size = 15, colour = "black"),
axis.title= element_text(face = "bold", size = 12, colour = "black"),
panel.background = element_blank(),
panel.border = element_rect(fill = NA, colour = "black"),
strip.text = element_text(size = 9, face = "bold"))
ggsave(
filename = here::here("final-figures", "barrier_points.png"),
plot = vis5,
width = 20,
height = 15,
units = "cm",
dpi = 720
)
#plot with barrier of peninsula absent/present with points
vis5 <- ggplot(mat4, aes(y = gend, x = geob)) +
geom_boxplot() +
geom_jitter(alpha = 0.5, width = 0.2) +
labs(y = "Genetic Distance (%)", x = "Biogeographic Barrier Absent/Present (0/1)") +
theme( axis.text.x = element_text(face = "bold",colour = "black", size = 15),
axis.text.y = element_text(face = "bold", size = 15, colour = "black"),
axis.title= element_text(face = "bold", size = 20, colour = "black"),
panel.background = element_blank(),
panel.border = element_rect(fill = NA, colour = "black"),
strip.text = element_text(size = 9, face = "bold"))
vis5
ggsave(
filename = here::here("final-figures", "barrier_points.png"),
plot = vis5,
width = 20,
height = 15,
units = "cm",
dpi = 720
)
#plot with barrier of peninsula absent/present with points
vis5 <- ggplot(mat4, aes(y = gend, x = geob)) +
geom_boxplot() +
geom_jitter(alpha = 1, width = 0.2) +
labs(y = "Genetic Distance (%)", x = "Biogeographic Barrier Absent/Present (0/1)") +
theme( axis.text.x = element_text(face = "bold",colour = "black", size = 15),
axis.text.y = element_text(face = "bold", size = 15, colour = "black"),
axis.title= element_text(face = "bold", size = 20, colour = "black"),
panel.background = element_blank(),
panel.border = element_rect(fill = NA, colour = "black"),
strip.text = element_text(size = 9, face = "bold"))
vis5
#plot with barrier of peninsula absent/present with points
vis5 <- ggplot(mat4, aes(y = gend, x = geob)) +
geom_boxplot() +
geom_jitter(alpha = 0.8, width = 0.2) +
labs(y = "Genetic Distance (%)", x = "Biogeographic Barrier Absent/Present (0/1)") +
theme( axis.text.x = element_text(face = "bold",colour = "black", size = 15),
axis.text.y = element_text(face = "bold", size = 15, colour = "black"),
axis.title= element_text(face = "bold", size = 20, colour = "black"),
panel.background = element_blank(),
panel.border = element_rect(fill = NA, colour = "black"),
strip.text = element_text(size = 9, face = "bold"))
vis5
#export plots as pdf
ggsave(
filename = here::here("final-figures", "euclidean.png"),
plot = vis,
width = 20,
height = 15,
units = "cm",
dpi = 720
)
ggsave(
filename = here::here("final-figures", "coastal.png"),
plot = vis2,
width = 20,
height = 15,
units = "cm",
dpi = 720
)
ggsave(
filename = here::here("final-figures", "oceanic.png"),
plot = vis3,
width = 20,
height = 15,
units = "cm",
dpi = 720
)
ggsave(
filename = here::here("final-figures", "barrier.png"),
plot = vis4,
width = 20,
height = 15,
units = "cm",
dpi = 720
)
ggsave(
filename = here::here("final-figures", "barrier_points.png"),
plot = vis5,
width = 20,
height = 15,
units = "cm",
dpi = 720
)
#plot euclidean geographic distance
vis <- ggplot(mat, aes(y = gend, x = geod)) +
geom_smooth(method = "lm", alpha =0.51, colour = "blue") +
geom_point(size =2, alpha = 1) +
labs(y = "Genetic Distance (%)", x = "Geographic Distance (km)") +
theme( axis.text.x = element_text(face = "bold",colour = "black", size = 15),
axis.text.y = element_text(face = "bold", size = 15, colour = "black"),
axis.title= element_text(face = "bold", size = 20, colour = "black"),
panel.background = element_blank(),
panel.border = element_rect(fill = NA, colour = "black"),
strip.text = element_text(size = 9, face = "bold"))
vis
#plot coastal distance
vis2 <- ggplot(mat2, aes(y = gend, x = geoc)) +
geom_smooth(method = "lm", alpha =0.51, colour = "blue") +
geom_point(size =2, alpha = 1) +
labs(y = "Genetic Distance (%)", x = "Coastal Distance (km)") +
theme( axis.text.x = element_text(face = "bold",colour = "black", size = 15),
axis.text.y = element_text(face = "bold", size = 15, colour = "black"),
axis.title= element_text(face = "bold", size = 20, colour = "black"),
panel.background = element_blank(),
panel.border = element_rect(fill = NA, colour = "black"),
strip.text = element_text(size = 9, face = "bold"))
vis2
#plot oceanic distance
vis3 <- ggplot(mat3, aes(y = gend, x = geoo)) +
geom_smooth(method = "lm", alpha =0.51, colour = "blue") +
geom_point(size =2, alpha = 1) +
labs(y = "Genetic Distance (%)", x = "Oceanic Distance (km)") +
theme( axis.text.x = element_text(face = "bold",colour = "black", size = 15),
axis.text.y = element_text(face = "bold", size = 15, colour = "black"),
axis.title= element_text(face = "bold", size = 20, colour = "black"),
panel.background = element_blank(),
panel.border = element_rect(fill = NA, colour = "black"),
strip.text = element_text(size = 9, face = "bold"))
vis3
#plot with barrier of peninsula absent/present
vis4 <- ggplot(mat4, aes(y = gend, x = geob)) +
geom_boxplot() +
labs(y = "Genetic Distance (%)", x = "Biogeographic Barrier Absent/Present (0/1)") +
theme( axis.text.x = element_text(face = "bold",colour = "black", size = 15),
axis.text.y = element_text(face = "bold", size = 15, colour = "black"),
axis.title= element_text(face = "bold", size = 20, colour = "black"),
panel.background = element_blank(),
panel.border = element_rect(fill = NA, colour = "black"),
strip.text = element_text(size = 9, face = "bold"))
vis4
#plot with barrier of peninsula absent/present with points
vis5 <- ggplot(mat4, aes(y = gend, x = geob)) +
geom_boxplot() +
geom_jitter(alpha = 0.8, width = 0.2) +
labs(y = "Genetic Distance (%)", x = "Biogeographic Barrier Absent/Present (0/1)") +
theme( axis.text.x = element_text(face = "bold",colour = "black", size = 15),
axis.text.y = element_text(face = "bold", size = 15, colour = "black"),
axis.title= element_text(face = "bold", size = 20, colour = "black"),
panel.background = element_blank(),
panel.border = element_rect(fill = NA, colour = "black"),
strip.text = element_text(size = 9, face = "bold"))
vis5
#export plots as pdf
ggsave(
filename = here::here("final-figures", "euclidean.png"),
plot = vis,
width = 20,
height = 15,
units = "cm",
dpi = 720
)
ggsave(
filename = here::here("final-figures", "coastal.png"),
plot = vis2,
width = 20,
height = 15,
units = "cm",
dpi = 720
)
ggsave(
filename = here::here("final-figures", "oceanic.png"),
plot = vis3,
width = 20,
height = 15,
units = "cm",
dpi = 720
)
ggsave(
filename = here::here("final-figures", "barrier.png"),
plot = vis4,
width = 20,
height = 15,
units = "cm",
dpi = 720
)
ggsave(
filename = here::here("final-figures", "barrier_points.png"),
plot = vis5,
width = 20,
height = 15,
units = "cm",
dpi = 720
)
git remote add origin git@github.com:carinamotta/suaeda-landscape-genetics.git
git remote add git@github.com:carinamotta/suaeda-landscape-genetics.git
